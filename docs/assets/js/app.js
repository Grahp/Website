const n=document.getElementById("app");if(!n)throw new Error("Single page app failed: 'app' element cannot be found.");const t=new Map,o=new Map;function c(n){if(!n)return window.scrollTo(0,0);const t=decodeURIComponent(n.slice(1));let o=null;try{o=document.getElementById(t)||document.querySelector(`#${CSS.escape(t)}`)}catch(n){o=document.getElementById(t)}o||(o=document.querySelector(`[name="${t}"]`)),o?((!o.tabIndex||o.tabIndex<0)&&(o.tabIndex=-1),o.scrollIntoView({behavior:"auto",t:"start"}),o.focus({o:!0})):window.scrollTo(0,0)}function e(n){const t=i(n),c=o.get(t)||{x:0,y:0};window.scrollTo(c.x,c.y)}function i(n){const[t]=n.split("#");return t||location.pathname}function a(n){return n.split("#")[1]}async function l(n){const o=t.get(n);if(o)return o;{const o=await async function(n){const t=await fetch(n,{method:"GET"});if(t.ok){const n=await t.text(),o=(new DOMParser).parseFromString(n,"text/html");return{app:o.getElementById("app"),title:o.title}}}(n);if(o?.app){const c={i:o.app.innerHTML,title:o.title||document.title};return t.set(n,c),c}}}async function u(t,u=!0){o.set(location.pathname,{x:window.scrollX,y:window.scrollY});const r=i(t),s=await l(r);s?(n.innerHTML=s.i,document.title=s.title||document.title,u?(history.pushState(null,"",t),c(a(t))):(e(r),c(a(t)))):location.href=t}document.addEventListener("click",n=>{const t=n.target.closest("a");if(t&&"_blank"!==t.target&&!n.metaKey&&!n.ctrlKey){const o=new URL(t.href,location.href);if(o.origin===location.origin){n.preventDefault();const t=o.pathname+o.search+o.hash;o.pathname===location.pathname&&o.search===location.search&&o.hash?(history.pushState(null,"",t),c(o.hash)):(u(t),e(t))}}}),window.addEventListener("popstate",()=>{u(location.pathname+location.search+location.hash,!1)});